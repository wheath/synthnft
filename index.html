<html>
  <head>
    <title>Synthetic Non-fungible Tokens</title>
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/4.0.1/web3.min.js"></script> 
    <script type='text/javascript'>
      var contract = undefined;
      var customProvider = undefined;
      var address = "0x6A4494ed32ce0Ab8004fbEAdac534916f88C8d3E";
      var abi = undefined;

      function notary_init() {
        // Check if Web3 has been injected by the browser (Mist/MetaMask)
        if (typeof web3 !== 'undefined') {
          // Use existing gateway
          window.web3 = new Web3(web3.currentProvider);
        } else {
          alert("No Ethereum interface injected into browser. Read-only access");
        }

        ethereum.enable()
      };

      let currentAccount = null;

      function handleAccountsChanged(accounts) {
        console.log("Calling HandleChanged");
        console.log(accounts);

        if (accounts.length === 0) {
          console.log("Please connect to MetaMask.");
          $("#enableMetamask").html("Connect with Metamask");
        } else if (accounts[0] !== currentAccount) {
        currentAccount = accounts[0];
        $("#enableMetamask").html(currentAccount);
        $("#status").html("");

        if (currentAccount != null) {
          // Set the button label
          $("#enableMetamask").html(currentAccount);
        }
      }
      console.log("WalletAddress in HandleAccountChanged =" + walletAddress);
    }

    function connect() {
      console.log("Calling connect()");
      ethereum
        .request({ method: "eth_requestAccounts" })
        .then(handleAccountsChanged)
        .catch((err) => {
        if (err.code === 4001) {
        // EIP-1193 userRejectedRequest error
        // If this happens, the user rejected the connection request.
        console.log("Please connect to MetaMask.");
        $("#status").html("You refused to connect Metamask");
      } else {
        console.log("_dbg error occured");
        console.error(err);
      }
    });
  }

  $(document).ready(function () {
    //notary_init();
    //const Web3 = require('web3'); // Load Web3 library
    //const web3 = new Web3(new Web3.providers.HttpProvider('https://moonbase-alpha.blastapi.io/98ff896c-8d2c-4adc-b82f-6ac373838418')); 
  
    $("#mybutton").click(function () {
      console.log("hello");
      connect();
    });
  });
  </script>
  </head>
  <body>
    <h1>Synthetic Non-fungible Tokens</h1>
    <button id="mybutton">Connect Metmask</button>
    <div id="enableMetamask"></div>
    <div id="status"></div>
    <button id="nftbutton">Create NFT</button>
  </body>
</html>
